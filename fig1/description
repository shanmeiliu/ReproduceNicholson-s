code for reproducing figure 1
